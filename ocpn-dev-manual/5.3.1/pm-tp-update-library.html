<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Update the Library :: OpenCPN Developer Manual</title>
    <link rel="canonical" href="https://opencpn-manuals.github.io/development/ocpn-dev-manual/5.3.1/pm-tp-update-library.html">
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../../_/css/site.css">
<link rel="icon" href="../../_/img/favicon.ico" type="image/x-icon">
    <script>var uiRootPath = '../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <div class="navbar">
    <div class="navbar-brand">
      <div class="ocpn-logo"> </div>
      <a class="navbar-title"
         href="https://opencpn-manuals.github.io/development"
      >
        OpenCPN Developer Manual
        </a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
       <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Resources</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://www.opencpn.org">OpenCPN.org</a>
            <a class="navbar-item"
               href="https://opencpn.org/wiki/dokuwiki/doku.php?id=opencpn:opencpn_user_manual"
            >
               User Manual
               </a>
            <a class="navbar-item" href="https://github.com/opencpn/OpenCPN">
               Github Site
               </a>
            <a class="navbar-item" href="https://opencpn.org/flyspray/">
               Bugtracker
               </a>
            <a class="navbar-item"
                href="https://rasbats.github.io/opencpn-plugins-manual/">
                    Plugin Manual (pre-alpha)
               </a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="ocpn-dev-manual" data-version="5.3.1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html">OpenCPN Developer Manual</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Developer Manual</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Introduction</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="intro-AboutThisManual.html">About this Manual</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="intro-Background.html">Background</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="intro-Community.html">Community</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="intro-Terminology.html">Terminology</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Opencpn development</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Compiling</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="od-compile-cmake.html">CMake</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="od-compile-linux.html">Linux</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="od-compile-linux.html#_flatpak">Flatpak</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="od-compile-windows.html">Windows</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="od-compile-mac-osx.html">MacOS</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="od-code-formatting.html">Code Formatting</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="od-user-interface-styling.html">User Interface Styling</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="od-troubleshooting.html">Troubleshooting</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Plugin Development</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="plugin-devel-overview.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="pm-plugin-dependencies.html">Dependencies</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="pm-plugin-api-versions.html">Plugin API and ABI</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="pm-overview-deployment.html">Deployment overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="pm-overview-workflow.html">Workflow overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="plugin-compat.html">Compatibility and tweaks</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="dm-i18n.html">Translations</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="Plugin-Pi-Adaptation.html">Plugin Installer Code Adaptation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="pm-tp-template.html">Testplugin Template</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="pm-overview-prereq-workflow.html">Workflow Prerequisites</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="pm-overview-prereq-services.html">Prerequisite Services</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="pm-overview-prereq-other.html">Cloudsmith Setup</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="pm-tp-system-structure.html">System Structure</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="pm-tp-dev-setup.html">Developer Setup</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="pm-tp-config-template.html">Configure Template</a>
  </li>
  <li class="nav-item" data-depth="3">
    <span class="nav-text">Build Locally</span>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="pm-tp-adapt-plugin.html">Adapt Plugin</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="pm-tp-deploy.html">Deploy Details</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="pi_installer_dev_procedure.html">PI Manager Dev Procedure</a>
  </li>
  <li class="nav-item is-current-page" data-depth="3">
    <a class="nav-link" href="pm-tp-update-library.html">Update the Library</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="pm-tp-language-nuance.html">Language Nuances</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="pm-tp-odapi-messaging.html">Odapi Messages</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="pm-tp-odapi.html">Odapi for oDraw</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="pm-tp-ocpn_draw_odapi.html">Ocpn_Draw Odapi</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../AlternativeWorkflow/index.html">Shipdriver Template</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../plugin-installer/0.0.1/Home.html">Plugin Manager Installer Documentation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://opencpn-manuals.github.io/plugins/opencpn-plugins/0.1/index.html">Plugin  Manual</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="dm-legacy-plugins.html">Legacy Plugin Packaging</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="dm-manual-maint.html">Maintenance of this Manual</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="dm-i18n.html">Internationalization</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Resources</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="res-prebuilt-build-files.html">Prebuilt Build Files</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="res-online-tools.html">Online Nmea Tools</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ECDIS_testdata.html">ECDIS testdata</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Reference</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="languages.html">Internationalization</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="prerequisites.html">Prerequisites</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="compile_mac_osx.html">Compiling on macOS</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="rpi2.html">Compile on Raspberry PI</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="building-on-armhf-linux-armbian-orange-pi.html">armhf linux - Armbian - Orange Pi</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">OpenCPN Developer Manual</span>
    <span class="version">5.3.1</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="index.html">OpenCPN Developer Manual</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="index.html">5.3.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../opencpn-plugins/0.1/index.html">OpenCPN Plugins</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../opencpn-plugins/0.1/index.html">0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../plugin-installer/0.0.1/Home.html">Plugin Installer Documentation</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../plugin-installer/0.0.1/Home.html">0.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../AlternativeWorkflow/index.html">Shipdriver Managed Workflow for the OpenCPN plugins</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../AlternativeWorkflow/index.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="intro-AboutThisManual.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">OpenCPN Developer Manual</a></li>
    <li>Developer Manual</li>
    <li>Plugin Development</li>
    <li><a href="pm-tp-template.html">Testplugin Template</a></li>
    <li><a href="pm-tp-update-library.html">Update the Library</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/opencpn-manuals/development/edit/build/modules/ROOT/pages/pm-tp-update-library.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Update the Library</h1>
<div id="preamble">
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>After Plugin Developer commits and pushes a Release, the PM system builds and deploys environments tarballs &amp; metadata to Cloudsmith.</p>
</li>
<li>
<p>All successfully built plugin metadata.xml&#8217;s are readily available in a Cloudsmith repository.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_plugin_developer_actions"><a class="anchor" href="#_plugin_developer_actions"></a>Plugin Developer actions:</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Uses github  and a script to tranfer the metadata.xmls from a Cloudsmith Repository to the 'library' github.com/opencn/plugins.</p>
</li>
<li>
<p>Removes older plugin releases if present.</p>
</li>
<li>
<p>Git adds and commits the changes to local git. Then pushes to their remote git repository.</p>
</li>
<li>
<p>Makes a Pull Request (PR) to 'library' github.com/opencpn/plugins master branch.</p>
</li>
<li>
<p>Confirms that the github action script accepts the PR.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>More Detail:
. Plugin Developer updates git local 'library' repository from upstream (opencpn/plugins).
. Executes a script to copy Cloudsmith metadata to the git a local "library'.
. Checks the new xml files added to the metadata directory and deletes the old xml files for the plugin.
. Uses Git to add the changes, make a commit and push to the plugin developer&#8217;s remote fork.
. Then from the online remote, makes a pull requesst to the 'library' opencpn/plugins master branch.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The metadate.xml file contains information necessary to download the essential Plugin tarball files into OpenCPN when the user chooses.</p>
</li>
<li>
<p>Refer to <a href="https://github.com/OpenCPN/plugins/blob/master/README.md">OpenCPN plugins project README</a></p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_library_maintainer_dave_reviews_pull_request"><a class="anchor" href="#_library_maintainer_dave_reviews_pull_request"></a>Library Maintainer Dave reviews Pull Request:</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Accepts or rejects the PR.</p>
</li>
<li>
<p>If the PR is accepted, the metadata.xml files are added to the Catalog Library</p>
</li>
<li>
<p>Users can then use the "Update Plugin Catalog" button in Options &gt; Plugins to update the catalog.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_catalog_now_available_to_the_user_in_options_plugins"><a class="anchor" href="#_catalog_now_available_to_the_user_in_options_plugins"></a>Catalog now available to the User in <strong>Options &gt; Plugins</strong></h2>
<div class="sectionbody">
<div class="paragraph">
<p>EDIT NEEDED BELOW</p>
</div>
<div class="paragraph">
<p>Add your new Metadata xml to Plugin Manager Catalog<br>
Make Pull Request to github.com/OpenCPN/Plugiins<br></p>
</div>
<div class="paragraph">
<p>After Circleci, Travis and Appveyor have built the environments and deployed to one of the Cloudsmith Repositories, the resultant metadata files (.xml) must be copied and pushed up too the plugins master branch github.com/OpenCPN/plugins to become part of the the master catalog. Jon Gough has provided some bash/python scripts that accomplish copy to your local branch to assist or you can simply do this part manually.</p>
</div>
<div class="paragraph">
<p>Generally try not to use raw git commands unless really needed, In Linux &amp; Windows install the 'beta' testing version (for free opensource work) SmartGit (sometimes it hasn&#8217;t had all the capabilities of git).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_use_a_manual_process_and_script"><a class="anchor" href="#_use_a_manual_process_and_script"></a>Use a Manual process and script</h2>
<div class="sectionbody">
<div class="paragraph">
<p>to move metadata.xml to github.com/plugins.</p>
</div>
<div class="paragraph">
<p>After completing  (Ewdwe ro Read-Build.md)</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Initial Setup of Remote Fork and Local Repository</p>
</li>
<li>
<p>Set remote upstream and origin</p>
</li>
<li>
<p>Create a new local branch, i.e. master or beta or alpha using upstream/master</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_update_your_local_githubplugins_master_beta_alpha_branches"><a class="anchor" href="#_update_your_local_githubplugins_master_beta_alpha_branches"></a>Update your local github/plugins  (master, beta, alpha branches)</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>git pull upstream master  &#8592;--need our local repos to match opencpn/plugins (master branch)</p>
</li>
<li>
<p>git push origin master  &#8592;--just updating our remote repository.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_copy_metadat_with_a_script"><a class="anchor" href="#_copy_metadat_with_a_script"></a>Copy metadat with a script</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Next copy the metadata.xml files from Cloudsmith to your local github/plugins metadirectory (master branch)<br>
Use the Git-Gui (bash prompt) from your local github/plugins' folder, to run Jon&#8217;s bash script.<br>
Note if you used an "_" in the name, try using "-" to get it to work!<br></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Run: 'download_xml_bash.sh' with the correct parameters for your cloudsmith repository and build.</p>
</li>
<li>
<p>Examples</p>
</li>
<li>
<p>./download_xml_bash.sh &lt;cloudsmith_repository&gt; &lt;plugin_version&gt;  &lt;cloudsmith_user&gt;  &lt;cloudsmith_level&gt;</p>
</li>
<li>
<p>./download_xml_bash.sh testplugin_pi 1.0.114.0 jon-gough prod</p>
</li>
<li>
<p>./download_xml_bash.sh weather-routing 1.13.8.0 opencpn prod</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_remove_old_plugin_metadata"><a class="anchor" href="#_remove_old_plugin_metadata"></a>Remove Old Plugin Metadata</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Next remove only your own OLD metadata.xml files from your local github/plugins/metadata directory. Leave the other xml files alone!</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_push_your_changes"><a class="anchor" href="#_push_your_changes"></a>Push your changes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Then add the changed files, commit and push to remote origin master branch
. git add metadata/    To add the metadata files
. git commit -am "[pluginname] v[version number]"         Commit the metadata files
. git push -u origin rg-master    (Does the same as two commands 'git branch --set-upstream-to=origin/jg_master'  and 'git push')</p>
</div>
<div class="paragraph">
<p>Goto upstream/master in a web browser and create pull request to OpenCPN/plugins master  &#8592;--- from [gitusername]/plugins rg-master<br></p>
</div>
<div class="paragraph">
<p>We can leave the local rg-master branch in place until the next job (see above)</p>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.
     Sources: https://gitlab.com/leamas/antora-ui-default
  </p>
</footer>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>
